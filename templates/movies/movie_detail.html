{% extends 'main.html' %}
{%block title%}{{movie.title}}{%endblock%}
{%block content%}
{%load static%}
    <strong>{{movie.category}}</strong>
    <div class="row">
        <div class="col-xl-3 col-lg-3 mb-4">
            <img src="{{movie.poster.url}}">
        </div>

        <div class="col-xl-6 col-lg-6">
            <h1>{{movie.title}}</h1>
            <p>{{movie.tagline}}</p>
            <div class="mb-4">
                <h4>Описание:</h4>{{movie.description}}
            </div>
        </div>

    </div>
    <h4>Информация о фильме</h4>
    <ul>
        <li>
            <span><b>Год: </b>{{movie.year}}</span>
        </li>
    </ul>
    <ul>
        <li>
            <span><b>Жанры: </b>{% for genre in movie.genres.all %}{{genre.name}} {% endfor %}</span>
        </li>
    </ul>
    <ul>
        <li>
            <span><b>Страна: </b>{{movie.country}}</span>
        </li>
    </ul>
    <ul>
        <li>
            <span><b>Премьера в мире: </b>{{movie.world_premiere}}</span>
        </li>
    </ul>
        <ul>
        <li>
            <span><b>Бюджет: </b>{{movie.budget}}$</span>
        </li>
    </ul>
        <ul>
        <li>
            <span><b>Сборы в США: </b>{{movie.fees_in_usa}}$</span>
        </li>
    </ul>
        <ul>
        <li>
            <span><b>Сборы в мире: </b>{{movie.fess_in_world}}$</span>
        </li>
    </ul>
    <div class="mb-4">
        <h4>Описание:</h4>{{movie.description}}
    </div>
    <h4>Режисеры и сценаристы</h4>
    <div class="md-4 row">
        {% for director in movie.directors.all %}
        <div class="col-xl-2 col-lg-2 col-md-2 mb-4">
            <a href="/" style="color:gray">
                <img class="bd-placeholder-img rounded-circle" width="100" height="100"  src="{{director.image.url}}">
                <h5>{{director.name}}</h5>
            </a>
        </div>
    </div>
    {% endfor %}
    <h4>Актеры</h4>
    <div class="row ">

        {% for actor in movie.actors.all %}
            <div class="col-xl-2 col-lg-2 col-md-2 mb-4">
                <a href="/" style="color:gray">
                    <img class="bd-placeholder-img rounded-circle" width="100" height="100"  src="{{actor.image.url}}">
                    <h5>{{actor.name}}</h5>
                </a>
            </div>
        {% endfor %}
    </div>

    <div>
        <h4>Кадры из фильма:</h4>
        {%for image in movie.movieshots_set.all%}
        <img src="{{image.image.url}}">
        {%endfor%}
    </div>

<form action="{% url 'add_review' movie.id %}" method="post" id="formReview" class="mt-4">
    {% csrf_token %}
    <h4>Оставить отзыв</h4>
    <div class="col-4 mb-4">
        <input type="hidden" name="parent" id="parent" value="">
        <div class="md-10">
            <textarea name="textcomm" id="comment" placeholder="Содержание" required cols="47" rows="5"></textarea>
        </div>
        <div class="d-sm-flex">
            <div class=" form-group p-0 editContent">
                <input type="text" name="namecomm" maxlength="50" required placeholder="Ваше Имя">
            </div>
            <div class=" form-group ml-sm-3 editContent">
                <input type="email" name="emailcomm" maxlength="60" required placeholder="Ваш Email">
            </div>
        </div>
        <button type="submit" class=" btn btn-success btn-block py-2">
            Отправить
        </button>
    </div>
</form>
<div>
    <h4>Отзывы </h4>
    {% for review in movie.get_review %}
            <div class="media py-1">
                <img src="{% static 'images/avatar_azamat.png' %}" class="mr-1 img-fluid" alt="image" width="60">
                <div class="media-body mt-4">
                    <h5 class="mt-0 editContent">
                        {{ review.name }}
                    </h5>
                    <p class="mt-2 editContent">
                        {{ review.text }}
                    </p>
                    <a href="#formReview"
                       onclick="addReview('{{ review.name }}', '{{ review.id }}')">Ответить</a>
                    {%for rew in review.reviews_set.all%}
                        <div class="media py-1">
                            <img src="{% static 'images/avatar_azamat.png' %}" class="mr-1 img-fluid" alt="image" width="60">
                            <div class="media-body mt-4">
                                <h5 class="mt-0 editContent">
                                    {{ rew.name }}
                                </h5>
                                <p class="mt-2 editContent">
                                    {{ rew.text }}
                                </p>
                            </div>
                    {%endfor%}
                </div>
            </div>
        {% endfor %}
</div>
</div>
    <script>
        function addReview(name, id) {
            document.getElementById("parent").value = id;
            document.getElementById("comment").innerText = `${name}, `
        }

    </script>
{%endblock%}